> 有网友反馈 # 导入Excel，随便一个Excel都能被导入，没有格式匹配校验，所以出了此方案。

## 通用Excel导入校验工具类 
 ```
ExcelImportCheckUtil.check(InputStream inputstream, Class<?> pojoClass, ImportParams params);
ExcelImportCheckUtil.check(InputStream inputstream, Class<?> pojoClass, ImportParams params, Double screenRate);
```
 ```
screenRate 匹配度 取值范围 0.1-0.9，默认值0.8
```



![](images/f29b45fa888e5e1ca2993e82bc3c7b5c_658x599.png)


##  如何使用？需要引入 autopoi 的maven依赖
```
<dependency>
  <groupId>org.jeecgframework</groupId>
  <artifactId>autopoi</artifactId>
  <version>2.0.1</version>
</dependency>
```
在ExcelImportUtil.importExcel之前调用
```
boolean aBoolean = ExcelImportCheckUtil.check(file.getInputStream(), SysDictPage.class, params);
```
参数详解
![](images/e1723d26fc564005052b881bbe33b8a0_894x89.png)
```
inputstream：文件输入流  一般用file.getInputStream()
pojoClass：当前导入的实体类名称（如SysUser.class）
params: 导入的参数
return ：返回值类型(true或false)，匹配度成功为true，失败为false
```
  